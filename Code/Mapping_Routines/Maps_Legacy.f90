   !#################################################################################!
 !/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\!
!######################################################################################!
!##!                                                                                !##!
!##!                                                                                !##!
MODULE Maps_Legacy                                                                  !##!
!##!                                                                                !##!
!##!________________________________________________________________________________!##!
!##!                                                                                !##!
!##!                                                                                !##!
!##!================================================================================!##!
!##!                                                                                !##!
!##!    Contains:                                                                   !##!
!##!                                                                                !##!
!##!    +201+   CFA_Matrix_Map                                                      !##!
!##!    +202+   CFA_1D_Matrix_Map                                                   !##!
!##!    +203+   CFA_2D_Matrix_Map                                                   !##!
!##!    +204+   CFA_3D_Matrix_Map                                                   !##!
!##!    +205+   CFA_1D_LM_Map                                                       !##!
!##!    +206+   CFA_2D_LM_Map                                                       !##!
!##!    +207+   CFA_3D_LM_Map                                                       !##!
!##!                                                                                !##!
!##!                                                                                !##!
!######################################################################################!
 !\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/!
   !#################################################################################!

!*D*================================!
!                                   !
!           Dependencies            !
!                                   !
!===================================!

USE Poseidon_Kinds_Module, &
            ONLY : idp

USE Poseidon_Numbers_Module, &
            ONLY : pi

USE Poseidon_Parameters, &
            ONLY :  DOMAIN_DIM,             &
                    DEGREE,                 &
                    L_LIMIT,                &
                    NUM_CFA_VARS

USE Variables_Derived, &
            ONLY :  ULM_LENGTH,             &
                    LM_LENGTH

IMPLICIT NONE


CONTAINS





!+102+##########################################################################!
!                                                                               !
!                  CFA_3D_Matrix_Map                                            !
!                                                                               !
!###############################################################################!
PURE FUNCTION CFA_ALL_Matrix_Map( ui, lm_loc, re, d )

INTEGER                                     :: CFA_ALL_Matrix_Map
INTEGER, INTENT(IN)                         :: ui, lm_loc, re, d



CFA_ALL_Matrix_Map = (re*DEGREE + d) * ULM_LENGTH           &
                   + (ui - 1) * LM_LENGTH                   &
                   + lm_loc


END FUNCTION CFA_ALL_Matrix_Map








END MODULE Maps_Legacy

